
open Utilities
open CEGAR_syntax
open CEGAR_type
open CEGAR_util

exception NoProgress
exception CannotDiscoverPredicate




let test_prog = 
(["main_1",(TBase(TUnit,fun x_225->[]));
  "cons_2",(TFun((TBase(TInt,fun x_227->[])),fun x_226->(TFun((TBase(TInt,fun x_229->[])),fun x_228->(TFun((TBase(TInt,fun x_231->[])),fun x_230->(TFun((TFun((TBase(TInt,fun x_234->[])),fun x_233->(TFun((TFun((TBase(TInt,fun x_237->[])),fun x_236->(TBase(TUnit,fun x_238->[])))),fun x_235->(TBase(TUnit,fun x_239->[])))))),fun x_232->(TFun((TBase(TInt,fun x_241->[])),fun x_240->(TFun((TFun((TFun((TBase(TInt,fun x_245->[])),fun x_244->(TFun((TFun((TBase(TInt,fun x_248->[])),fun x_247->(TBase(TUnit,fun x_249->[])))),fun x_246->(TBase(TUnit,fun x_250->[])))))),fun x_243->(TFun((TBase(TInt,fun x_252->[])),fun x_251->(TBase(TUnit,fun x_253->[])))))),fun x_242->(TBase(TUnit,fun x_254->[]))))))))))))));
  "cons_9",(TFun((TBase(TInt,fun x_256->[])),fun x_255->(TFun((TBase(TInt,fun x_258->[])),fun x_257->(TFun((TFun((TBase(TInt,fun x_261->[])),fun x_260->(TFun((TFun((TBase(TInt,fun x_264->[])),fun x_263->(TBase(TUnit,fun x_265->[])))),fun x_262->(TBase(TUnit,fun x_266->[])))))),fun x_259->(TFun((TBase(TInt,fun x_268->[(App((App((Const Geq),(x_268))),(Const (Int 1))))])),fun x_267->(TFun((TFun((TFun((TBase(TInt,fun x_272->[])),fun x_271->(TFun((TFun((TBase(TInt,fun x_275->[])),fun x_274->(TBase(TUnit,fun x_276->[])))),fun x_273->(TBase(TUnit,fun x_277->[])))))),fun x_270->(TFun((TBase(TInt,fun x_279->[])),fun x_278->(TBase(TUnit,fun x_280->[])))))),fun x_269->(TBase(TUnit,fun x_281->[]))))))))))));
  "cons_15",(TFun((TBase(TInt,fun x_283->[])),fun x_282->(TFun((TBase(TInt,fun x_285->[])),fun x_284->(TFun((TFun((TBase(TInt,fun x_288->[])),fun x_287->(TFun((TFun((TBase(TInt,fun x_291->[])),fun x_290->(TBase(TUnit,fun x_292->[])))),fun x_289->(TBase(TUnit,fun x_293->[])))))),fun x_286->(TFun((TBase(TInt,fun x_295->[(App((App((Const Geq),(x_295))),(Const (Int 0))))])),fun x_294->(TFun((TFun((TFun((TBase(TInt,fun x_299->[])),fun x_298->(TFun((TFun((TBase(TInt,fun x_302->[])),fun x_301->(TBase(TUnit,fun x_303->[])))),fun x_300->(TBase(TUnit,fun x_304->[])))))),fun x_297->(TFun((TBase(TInt,fun x_306->[(App((App((Const Geq),(x_306))),(Const (Int 1))))])),fun x_305->(TBase(TUnit,fun x_307->[])))))),fun x_296->(TBase(TUnit,fun x_308->[]))))))))))));
  "cons_21",(TFun((TBase(TInt,fun x_310->[])),fun x_309->(TFun((TFun((TBase(TInt,fun x_313->[])),fun x_312->(TFun((TFun((TBase(TInt,fun x_316->[])),fun x_315->(TBase(TUnit,fun x_317->[])))),fun x_314->(TBase(TUnit,fun x_318->[])))))),fun x_311->(TFun((TBase(TInt,fun x_320->[(App((App((Const Geq),(x_320))),(Const (Int 2))));(App((App((Const Geq),(x_320))),(Const (Int 1))))])),fun x_319->(TFun((TFun((TBase(TInt,fun x_323->[])),fun x_322->(TFun((TFun((TFun((TBase(TInt,fun x_327->[])),fun x_326->(TFun((TFun((TBase(TInt,fun x_330->[])),fun x_329->(TBase(TUnit,fun x_331->[])))),fun x_328->(TBase(TUnit,fun x_332->[])))))),fun x_325->(TFun((TBase(TInt,fun x_334->[(App((App((Const Geq),(x_334))),(Const (Int 2))));(App((App((Const Geq),(x_334))),(Const (Int 1))))])),fun x_333->(TBase(TUnit,fun x_335->[])))))),fun x_324->(TBase(TUnit,fun x_336->[])))))),fun x_321->(TFun((TBase(TInt,fun x_338->[(App((App((Const EqInt),(x_338))),(Const (Int 0))))])),fun x_337->(TFun((TFun((TFun((TBase(TInt,fun x_342->[(App((App((Const Geq),(x_342))),(Const (Int 1))))])),fun x_341->(TFun((TFun((TFun((TBase(TInt,fun x_346->[])),fun x_345->(TFun((TFun((TBase(TInt,fun x_349->[])),fun x_348->(TBase(TUnit,fun x_350->[])))),fun x_347->(TBase(TUnit,fun x_351->[])))))),fun x_344->(TFun((TBase(TInt,fun x_353->[(App((App((Const Geq),(x_353))),(Const (Int 2))));(App((App((Const Geq),(x_353))),(Const (Int 1))))])),fun x_352->(TBase(TUnit,fun x_354->[])))))),fun x_343->(TBase(TUnit,fun x_355->[])))))),fun x_340->(TFun((TBase(TInt,fun x_357->[(App((App((Const EqInt),(x_357))),(Const (Int 1))))])),fun x_356->(TBase(TUnit,fun x_358->[])))))),fun x_339->(TBase(TUnit,fun x_359->[]))))))))))))));
  "f_28",(TFun((TBase(TInt,fun x_361->[])),fun x_360->(TFun((TBase(TInt,fun x_363->[])),fun x_362->(TFun((TBase(TInt,fun x_365->[])),fun x_364->(TFun((TFun((TBase(TInt,fun x_368->[])),fun x_367->(TFun((TFun((TBase(TInt,fun x_371->[])),fun x_370->(TBase(TUnit,fun x_372->[])))),fun x_369->(TBase(TUnit,fun x_373->[])))))),fun x_366->(TFun((TBase(TInt,fun x_375->[])),fun x_374->(TFun((TFun((TBase(TInt,fun x_378->[])),fun x_377->(TBase(TUnit,fun x_379->[])))),fun x_376->(TBase(TUnit,fun x_380->[]))))))))))))));
  "f_42",(TFun((TBase(TInt,fun x_382->[])),fun x_381->(TFun((TBase(TInt,fun x_384->[])),fun x_383->(TFun((TFun((TBase(TInt,fun x_387->[])),fun x_386->(TBase(TUnit,fun x_388->[])))),fun x_385->(TBase(TUnit,fun x_389->[]))))))));
  "f_46",(TFun((TBase(TInt,fun x_391->[])),fun x_390->(TFun((TBase(TInt,fun x_393->[])),fun x_392->(TFun((TBase(TInt,fun x_395->[])),fun x_394->(TFun((TFun((TBase(TInt,fun x_398->[])),fun x_397->(TFun((TFun((TBase(TInt,fun x_401->[])),fun x_400->(TBase(TUnit,fun x_402->[])))),fun x_399->(TBase(TUnit,fun x_403->[])))))),fun x_396->(TFun((TBase(TInt,fun x_405->[])),fun x_404->(TFun((TFun((TBase(TInt,fun x_408->[])),fun x_407->(TBase(TUnit,fun x_409->[])))),fun x_406->(TBase(TUnit,fun x_410->[]))))))))))))));
  "f_60",(TFun((TBase(TInt,fun x_412->[])),fun x_411->(TFun((TBase(TInt,fun x_414->[])),fun x_413->(TFun((TFun((TFun((TBase(TInt,fun x_418->[])),fun x_417->(TFun((TFun((TBase(TInt,fun x_421->[])),fun x_420->(TBase(TUnit,fun x_422->[])))),fun x_419->(TBase(TUnit,fun x_423->[])))))),fun x_416->(TFun((TBase(TInt,fun x_425->[])),fun x_424->(TBase(TUnit,fun x_426->[])))))),fun x_415->(TBase(TUnit,fun x_427->[]))))))));
  "f_64",(TFun((TBase(TInt,fun x_429->[])),fun x_428->(TFun((TBase(TInt,fun x_431->[(App((App((Const Geq),(x_431))),(Const (Int 2))));(App((App((Const Geq),(x_431))),(Const (Int 1))))])),fun x_430->(TFun((TBase(TInt,fun x_433->[])),fun x_432->(TFun((TFun((TBase(TInt,fun x_436->[])),fun x_435->(TFun((TFun((TBase(TInt,fun x_439->[])),fun x_438->(TBase(TUnit,fun x_440->[])))),fun x_437->(TBase(TUnit,fun x_441->[])))))),fun x_434->(TFun((TFun((TBase(TInt,fun x_444->[])),fun x_443->(TFun((TFun((TFun((TBase(TInt,fun x_448->[])),fun x_447->(TFun((TFun((TBase(TInt,fun x_451->[])),fun x_450->(TBase(TUnit,fun x_452->[])))),fun x_449->(TBase(TUnit,fun x_453->[])))))),fun x_446->(TFun((TBase(TInt,fun x_455->[(App((App((Const Geq),(x_455))),(Const (Int 2))));(App((App((Const Geq),(x_455))),(Const (Int 1))))])),fun x_454->(TBase(TUnit,fun x_456->[])))))),fun x_445->(TBase(TUnit,fun x_457->[])))))),fun x_442->(TFun((TBase(TInt,fun x_459->[(App((App((Const Geq),(x_459))),(Const (Int 1))))])),fun x_458->(TFun((TFun((TFun((TBase(TInt,fun x_463->[])),fun x_462->(TFun((TFun((TBase(TInt,fun x_466->[])),fun x_465->(TBase(TUnit,fun x_467->[])))),fun x_464->(TBase(TUnit,fun x_468->[])))))),fun x_461->(TFun((TBase(TInt,fun x_470->[(App((App((Const Geq),(x_470))),(Const (Int 2))));(App((App((Const Geq),(x_470))),(Const (Int 1))))])),fun x_469->(TBase(TUnit,fun x_471->[])))))),fun x_460->(TBase(TUnit,fun x_472->[]))))))))))))))));
  "f_80",(TFun((TBase(TInt,fun x_474->[])),fun x_473->(TFun((TFun((TBase(TInt,fun x_477->[])),fun x_476->(TFun((TFun((TBase(TInt,fun x_480->[])),fun x_479->(TBase(TUnit,fun x_481->[])))),fun x_478->(TBase(TUnit,fun x_482->[])))))),fun x_475->(TFun((TBase(TInt,fun x_484->[])),fun x_483->(TFun((TFun((TBase(TInt,fun x_487->[])),fun x_486->(TBase(TUnit,fun x_488->[])))),fun x_485->(TBase(TUnit,fun x_489->[]))))))))));
  "f_85",(TFun((TBase(TInt,fun x_491->[])),fun x_490->(TFun((TBase(TInt,fun x_493->[])),fun x_492->(TFun((TFun((TBase(TInt,fun x_496->[])),fun x_495->(TBase(TUnit,fun x_497->[])))),fun x_494->(TBase(TUnit,fun x_498->[]))))))));
  "f_89",(TFun((TBase(TInt,fun x_500->[])),fun x_499->(TFun((TFun((TBase(TInt,fun x_503->[(App((App((Const Geq),(x_503))),(Const (Int 1))))])),fun x_502->(TFun((TFun((TFun((TBase(TInt,fun x_507->[])),fun x_506->(TFun((TFun((TBase(TInt,fun x_510->[])),fun x_509->(TBase(TUnit,fun x_511->[])))),fun x_508->(TBase(TUnit,fun x_512->[])))))),fun x_505->(TFun((TBase(TInt,fun x_514->[(App((App((Const Geq),(x_514))),(Const (Int 1))))])),fun x_513->(TBase(TUnit,fun x_515->[])))))),fun x_504->(TBase(TUnit,fun x_516->[])))))),fun x_501->(TFun((TBase(TInt,fun x_518->[(App((App((Const Geq),(x_518))),(Const (Int 0))))])),fun x_517->(TFun((TFun((TFun((TBase(TInt,fun x_522->[])),fun x_521->(TFun((TFun((TBase(TInt,fun x_525->[])),fun x_524->(TBase(TUnit,fun x_526->[])))),fun x_523->(TBase(TUnit,fun x_527->[])))))),fun x_520->(TFun((TBase(TInt,fun x_529->[(App((App((Const Geq),(x_529))),(Const (Int 1))))])),fun x_528->(TBase(TUnit,fun x_530->[])))))),fun x_519->(TBase(TUnit,fun x_531->[]))))))))));
  "f_94",(TFun((TBase(TInt,fun x_533->[])),fun x_532->(TFun((TBase(TInt,fun x_535->[])),fun x_534->(TFun((TBase(TInt,fun x_537->[])),fun x_536->(TFun((TBase(TInt,fun x_539->[])),fun x_538->(TFun((TFun((TBase(TInt,fun x_542->[])),fun x_541->(TFun((TFun((TBase(TInt,fun x_545->[])),fun x_544->(TBase(TUnit,fun x_546->[])))),fun x_543->(TBase(TUnit,fun x_547->[])))))),fun x_540->(TFun((TBase(TInt,fun x_549->[])),fun x_548->(TFun((TFun((TBase(TInt,fun x_552->[])),fun x_551->(TBase(TUnit,fun x_553->[])))),fun x_550->(TBase(TUnit,fun x_554->[]))))))))))))))));
  "f_110",(TFun((TBase(TBool,fun x_556->[(x_556)])),fun x_555->(TFun((TFun((TBase(TInt,fun x_559->[])),fun x_558->(TFun((TFun((TBase(TInt,fun x_562->[])),fun x_561->(TBase(TUnit,fun x_563->[])))),fun x_560->(TBase(TUnit,fun x_564->[])))))),fun x_557->(TFun((TBase(TInt,fun x_566->[])),fun x_565->(TFun((TFun((TBase(TInt,fun x_569->[])),fun x_568->(TBase(TUnit,fun x_570->[])))),fun x_567->(TBase(TUnit,fun x_571->[]))))))))));
  "f_120",(TFun((TBase(TBool,fun x_573->[(x_573)])),fun x_572->(TFun((TFun((TFun((TBase(TInt,fun x_577->[])),fun x_576->(TFun((TFun((TBase(TInt,fun x_580->[])),fun x_579->(TBase(TUnit,fun x_581->[])))),fun x_578->(TBase(TUnit,fun x_582->[])))))),fun x_575->(TFun((TBase(TInt,fun x_584->[(App((App((Const And),(App((App((Const EqBool),(Const True))),(x_572))))),(App((App((Const Geq),(x_584))),(Const (Int 2))))));(App((App((Const And),(App((App((Const EqBool),(Const True))),(x_572))))),(App((App((Const Geq),(x_584))),(Const (Int 1))))))])),fun x_583->(TFun((TFun((TBase(TInt,fun x_587->[])),fun x_586->(TBase(TUnit,fun x_588->[])))),fun x_585->(TBase(TUnit,fun x_589->[])))))))),fun x_574->(TFun((TFun((TBase(TInt,fun x_592->[(App((App((Const And),(App((App((Const EqBool),(Const True))),(x_572))))),(App((App((Const Geq),(x_592))),(Const (Int 1))))));(App((App((Const And),(App((App((Const EqBool),(Const True))),(x_572))))),(App((App((Const Geq),(x_592))),(Const (Int 0))))))])),fun x_591->(TFun((TFun((TFun((TBase(TInt,fun x_596->[])),fun x_595->(TFun((TFun((TBase(TInt,fun x_599->[])),fun x_598->(TBase(TUnit,fun x_600->[])))),fun x_597->(TBase(TUnit,fun x_601->[])))))),fun x_594->(TFun((TBase(TInt,fun x_603->[(App((App((Const Geq),(x_603))),(Const (Int 2))));(App((App((Const Geq),(x_603))),(Const (Int 1))))])),fun x_602->(TBase(TUnit,fun x_604->[])))))),fun x_593->(TBase(TUnit,fun x_605->[])))))),fun x_590->(TFun((TBase(TInt,fun x_607->[(App((App((Const EqInt),(x_607))),(Const (Int 1))))])),fun x_606->(TFun((TFun((TFun((TBase(TInt,fun x_611->[])),fun x_610->(TFun((TFun((TBase(TInt,fun x_614->[])),fun x_613->(TBase(TUnit,fun x_615->[])))),fun x_612->(TBase(TUnit,fun x_616->[])))))),fun x_609->(TFun((TBase(TInt,fun x_618->[])),fun x_617->(TBase(TUnit,fun x_619->[])))))),fun x_608->(TBase(TUnit,fun x_620->[]))))))))))));
  "head_132",(TFun((TFun((TBase(TInt,fun x_623->[])),fun x_622->(TFun((TFun((TBase(TInt,fun x_626->[])),fun x_625->(TBase(TUnit,fun x_627->[])))),fun x_624->(TBase(TUnit,fun x_628->[])))))),fun x_621->(TFun((TBase(TInt,fun x_630->[(App((App((Const Geq),(x_630))),(Const (Int 2))));(App((App((Const Geq),(x_630))),(Const (Int 1))))])),fun x_629->(TFun((TFun((TBase(TInt,fun x_633->[])),fun x_632->(TBase(TUnit,fun x_634->[])))),fun x_631->(TBase(TUnit,fun x_635->[]))))))));
  "k_140",(TFun((TBase(TInt,fun x_637->[])),fun x_636->(TFun((TFun((TFun((TBase(TInt,fun x_641->[])),fun x_640->(TFun((TFun((TBase(TInt,fun x_644->[])),fun x_643->(TBase(TUnit,fun x_645->[])))),fun x_642->(TBase(TUnit,fun x_646->[])))))),fun x_639->(TFun((TBase(TInt,fun x_648->[(App((App((Const Geq),(x_648))),(Const (Int 2))))])),fun x_647->(TBase(TUnit,fun x_649->[])))))),fun x_638->(TFun((TBase(TInt,fun x_651->[])),fun x_650->(TBase(TUnit,fun x_652->[]))))))));
  "k_144",(TFun((TBase(TInt,fun x_654->[])),fun x_653->(TFun((TBase(TInt,fun x_656->[])),fun x_655->(TFun((TFun((TFun((TBase(TInt,fun x_660->[])),fun x_659->(TFun((TFun((TBase(TInt,fun x_663->[])),fun x_662->(TBase(TUnit,fun x_664->[])))),fun x_661->(TBase(TUnit,fun x_665->[])))))),fun x_658->(TFun((TBase(TInt,fun x_667->[(App((App((Const Geq),(x_667))),(Const (Int 2))))])),fun x_666->(TBase(TUnit,fun x_668->[])))))),fun x_657->(TFun((TFun((TBase(TInt,fun x_671->[])),fun x_670->(TFun((TFun((TBase(TInt,fun x_674->[])),fun x_673->(TBase(TUnit,fun x_675->[])))),fun x_672->(TBase(TUnit,fun x_676->[])))))),fun x_669->(TFun((TBase(TInt,fun x_678->[(App((App((Const Geq),(x_678))),(Const (Int 1))))])),fun x_677->(TBase(TUnit,fun x_679->[]))))))))))));
  "k_150",(TFun((TBase(TInt,fun x_681->[])),fun x_680->(TFun((TFun((TFun((TBase(TInt,fun x_685->[(App((App((Const Geq),(x_685))),(Const (Int 1))))])),fun x_684->(TFun((TFun((TFun((TBase(TInt,fun x_689->[])),fun x_688->(TFun((TFun((TBase(TInt,fun x_692->[])),fun x_691->(TBase(TUnit,fun x_693->[])))),fun x_690->(TBase(TUnit,fun x_694->[])))))),fun x_687->(TFun((TBase(TInt,fun x_696->[(App((App((Const Geq),(x_696))),(Const (Int 2))));(App((App((Const Geq),(x_696))),(Const (Int 1))))])),fun x_695->(TBase(TUnit,fun x_697->[])))))),fun x_686->(TBase(TUnit,fun x_698->[])))))),fun x_683->(TFun((TBase(TInt,fun x_700->[(App((App((Const EqInt),(x_700))),(Const (Int 1))))])),fun x_699->(TBase(TUnit,fun x_701->[])))))),fun x_682->(TFun((TFun((TBase(TInt,fun x_704->[])),fun x_703->(TFun((TFun((TBase(TInt,fun x_707->[])),fun x_706->(TBase(TUnit,fun x_708->[])))),fun x_705->(TBase(TUnit,fun x_709->[])))))),fun x_702->(TFun((TBase(TInt,fun x_711->[(App((App((Const Geq),(x_711))),(Const (Int 2))));(App((App((Const Geq),(x_711))),(Const (Int 1))))])),fun x_710->(TBase(TUnit,fun x_712->[]))))))))));
  "k_155",(TFun((TBase(TInt,fun x_714->[])),fun x_713->(TFun((TFun((TFun((TBase(TInt,fun x_718->[(App((App((Const Geq),(x_718))),(Const (Int 1))))])),fun x_717->(TFun((TFun((TFun((TBase(TInt,fun x_722->[])),fun x_721->(TFun((TFun((TBase(TInt,fun x_725->[])),fun x_724->(TBase(TUnit,fun x_726->[])))),fun x_723->(TBase(TUnit,fun x_727->[])))))),fun x_720->(TFun((TBase(TInt,fun x_729->[(App((App((Const Geq),(x_729))),(Const (Int 2))));(App((App((Const Geq),(x_729))),(Const (Int 1))))])),fun x_728->(TBase(TUnit,fun x_730->[])))))),fun x_719->(TBase(TUnit,fun x_731->[])))))),fun x_716->(TFun((TBase(TInt,fun x_733->[(App((App((Const EqInt),(x_733))),(Const (Int 1))))])),fun x_732->(TBase(TUnit,fun x_734->[])))))),fun x_715->(TFun((TBase(TInt,fun x_736->[])),fun x_735->(TBase(TUnit,fun x_737->[]))))))));
  "k_159",(TFun((TBase(TInt,fun x_739->[])),fun x_738->(TFun((TBase(TInt,fun x_741->[(App((App((Const Geq),(x_741))),(Const (Int 2))));(App((App((Const Geq),(x_741))),(Const (Int 1))))])),fun x_740->(TFun((TFun((TFun((TBase(TInt,fun x_745->[(App((App((Const Geq),(x_745))),(Const (Int 1))))])),fun x_744->(TFun((TFun((TFun((TBase(TInt,fun x_749->[])),fun x_748->(TFun((TFun((TBase(TInt,fun x_752->[])),fun x_751->(TBase(TUnit,fun x_753->[])))),fun x_750->(TBase(TUnit,fun x_754->[])))))),fun x_747->(TFun((TBase(TInt,fun x_756->[(App((App((Const Geq),(x_756))),(Const (Int 2))));(App((App((Const Geq),(x_756))),(Const (Int 1))))])),fun x_755->(TBase(TUnit,fun x_757->[])))))),fun x_746->(TBase(TUnit,fun x_758->[])))))),fun x_743->(TFun((TBase(TInt,fun x_760->[(App((App((Const EqInt),(x_760))),(Const (Int 1))))])),fun x_759->(TBase(TUnit,fun x_761->[])))))),fun x_742->(TFun((TFun((TBase(TInt,fun x_764->[])),fun x_763->(TFun((TFun((TBase(TInt,fun x_767->[])),fun x_766->(TBase(TUnit,fun x_768->[])))),fun x_765->(TBase(TUnit,fun x_769->[])))))),fun x_762->(TFun((TFun((TBase(TInt,fun x_772->[])),fun x_771->(TFun((TFun((TFun((TBase(TInt,fun x_776->[])),fun x_775->(TFun((TFun((TBase(TInt,fun x_779->[])),fun x_778->(TBase(TUnit,fun x_780->[])))),fun x_777->(TBase(TUnit,fun x_781->[])))))),fun x_774->(TFun((TBase(TInt,fun x_783->[(App((App((Const Geq),(x_783))),(Const (Int 1))))])),fun x_782->(TBase(TUnit,fun x_784->[])))))),fun x_773->(TBase(TUnit,fun x_785->[])))))),fun x_770->(TFun((TBase(TInt,fun x_787->[(App((App((Const EqInt),(x_787))),(Const (Int 0))))])),fun x_786->(TBase(TUnit,fun x_788->[]))))))))))))));
  "k_166",(TFun((TBase(TInt,fun x_790->[])),fun x_789->(TFun((TBase(TUnit,fun x_792->[])),fun x_791->(TBase(TUnit,fun x_793->[]))))));
  "k_169",(TFun((TBase(TInt,fun x_795->[(App((App((Const EqInt),(x_795))),(Const (Int 1))))])),fun x_794->(TFun((TFun((TFun((TBase(TInt,fun x_799->[])),fun x_798->(TFun((TFun((TBase(TInt,fun x_802->[])),fun x_801->(TBase(TUnit,fun x_803->[])))),fun x_800->(TBase(TUnit,fun x_804->[])))))),fun x_797->(TFun((TBase(TInt,fun x_806->[(App((App((Const Geq),(x_806))),(Const (Int 2))));(App((App((Const Geq),(x_806))),(Const (Int 1))))])),fun x_805->(TFun((TFun((TBase(TInt,fun x_809->[])),fun x_808->(TBase(TUnit,fun x_810->[])))),fun x_807->(TBase(TUnit,fun x_811->[])))))))),fun x_796->(TFun((TFun((TFun((TBase(TInt,fun x_815->[])),fun x_814->(TFun((TFun((TBase(TInt,fun x_818->[])),fun x_817->(TBase(TUnit,fun x_819->[])))),fun x_816->(TBase(TUnit,fun x_820->[])))))),fun x_813->(TFun((TBase(TInt,fun x_822->[])),fun x_821->(TBase(TUnit,fun x_823->[])))))),fun x_812->(TFun((TFun((TBase(TInt,fun x_826->[(App((App((Const Geq),(x_826))),(Const (Int 1))))])),fun x_825->(TFun((TFun((TFun((TBase(TInt,fun x_830->[])),fun x_829->(TFun((TFun((TBase(TInt,fun x_833->[])),fun x_832->(TBase(TUnit,fun x_834->[])))),fun x_831->(TBase(TUnit,fun x_835->[])))))),fun x_828->(TFun((TBase(TInt,fun x_837->[(App((App((Const Geq),(x_837))),(Const (Int 1))))])),fun x_836->(TBase(TUnit,fun x_838->[])))))),fun x_827->(TBase(TUnit,fun x_839->[])))))),fun x_824->(TFun((TFun((TBase(TInt,fun x_842->[])),fun x_841->(TFun((TFun((TBase(TInt,fun x_845->[])),fun x_844->(TBase(TUnit,fun x_846->[])))),fun x_843->(TBase(TUnit,fun x_847->[])))))),fun x_840->(TFun((TBase(TInt,fun x_849->[(App((App((Const Geq),(x_849))),(Const (Int 2))));(App((App((Const Geq),(x_849))),(Const (Int 1))))])),fun x_848->(TBase(TUnit,fun x_850->[]))))))))))))));
  "k_176",(TFun((TBase(TInt,fun x_852->[])),fun x_851->(TFun((TBase(TInt,fun x_854->[(App((App((Const EqInt),(x_854))),(Const (Int 1))))])),fun x_853->(TFun((TFun((TFun((TBase(TInt,fun x_858->[])),fun x_857->(TFun((TFun((TBase(TInt,fun x_861->[])),fun x_860->(TBase(TUnit,fun x_862->[])))),fun x_859->(TBase(TUnit,fun x_863->[])))))),fun x_856->(TFun((TBase(TInt,fun x_865->[(App((App((Const Geq),(x_865))),(Const (Int 1))))])),fun x_864->(TFun((TFun((TBase(TInt,fun x_868->[])),fun x_867->(TBase(TUnit,fun x_869->[])))),fun x_866->(TBase(TUnit,fun x_870->[])))))))),fun x_855->(TFun((TFun((TFun((TBase(TInt,fun x_874->[])),fun x_873->(TFun((TFun((TBase(TInt,fun x_877->[])),fun x_876->(TBase(TUnit,fun x_878->[])))),fun x_875->(TBase(TUnit,fun x_879->[])))))),fun x_872->(TFun((TBase(TInt,fun x_881->[])),fun x_880->(TBase(TUnit,fun x_882->[])))))),fun x_871->(TFun((TFun((TBase(TInt,fun x_885->[(App((App((Const Geq),(x_885))),(Const (Int 1))))])),fun x_884->(TFun((TFun((TFun((TBase(TInt,fun x_889->[])),fun x_888->(TFun((TFun((TBase(TInt,fun x_892->[])),fun x_891->(TBase(TUnit,fun x_893->[])))),fun x_890->(TBase(TUnit,fun x_894->[])))))),fun x_887->(TFun((TBase(TInt,fun x_896->[(App((App((Const Geq),(x_896))),(Const (Int 1))))])),fun x_895->(TBase(TUnit,fun x_897->[])))))),fun x_886->(TBase(TUnit,fun x_898->[])))))),fun x_883->(TFun((TBase(TInt,fun x_900->[])),fun x_899->(TBase(TUnit,fun x_901->[]))))))))))))));
  "k_183",(TFun((TBase(TInt,fun x_903->[])),fun x_902->(TFun((TBase(TInt,fun x_905->[])),fun x_904->(TFun((TBase(TInt,fun x_907->[])),fun x_906->(TFun((TFun((TFun((TBase(TInt,fun x_911->[])),fun x_910->(TFun((TFun((TBase(TInt,fun x_914->[])),fun x_913->(TBase(TUnit,fun x_915->[])))),fun x_912->(TBase(TUnit,fun x_916->[])))))),fun x_909->(TFun((TBase(TInt,fun x_918->[])),fun x_917->(TBase(TUnit,fun x_919->[])))))),fun x_908->(TFun((TFun((TBase(TInt,fun x_922->[])),fun x_921->(TFun((TFun((TBase(TInt,fun x_925->[])),fun x_924->(TBase(TUnit,fun x_926->[])))),fun x_923->(TBase(TUnit,fun x_927->[])))))),fun x_920->(TFun((TBase(TInt,fun x_929->[])),fun x_928->(TBase(TUnit,fun x_930->[]))))))))))))));
  "k_190",(TFun((TBase(TInt,fun x_932->[])),fun x_931->(TFun((TFun((TFun((TBase(TInt,fun x_936->[])),fun x_935->(TFun((TFun((TBase(TInt,fun x_939->[])),fun x_938->(TBase(TUnit,fun x_940->[])))),fun x_937->(TBase(TUnit,fun x_941->[])))))),fun x_934->(TFun((TBase(TInt,fun x_943->[])),fun x_942->(TBase(TUnit,fun x_944->[])))))),fun x_933->(TFun((TFun((TBase(TInt,fun x_947->[(App((App((Const Geq),(x_947))),(Const (Int 1))))])),fun x_946->(TFun((TFun((TFun((TBase(TInt,fun x_951->[])),fun x_950->(TFun((TFun((TBase(TInt,fun x_954->[])),fun x_953->(TBase(TUnit,fun x_955->[])))),fun x_952->(TBase(TUnit,fun x_956->[])))))),fun x_949->(TFun((TBase(TInt,fun x_958->[(App((App((Const Geq),(x_958))),(Const (Int 2))));(App((App((Const Geq),(x_958))),(Const (Int 1))))])),fun x_957->(TBase(TUnit,fun x_959->[])))))),fun x_948->(TBase(TUnit,fun x_960->[])))))),fun x_945->(TFun((TBase(TInt,fun x_962->[(App((App((Const EqInt),(x_962))),(Const (Int 1))))])),fun x_961->(TBase(TUnit,fun x_963->[]))))))))));
  "k_195",(TFun((TFun((TBase(TInt,fun x_966->[])),fun x_965->(TFun((TFun((TBase(TInt,fun x_969->[])),fun x_968->(TBase(TUnit,fun x_970->[])))),fun x_967->(TBase(TUnit,fun x_971->[])))))),fun x_964->(TFun((TBase(TInt,fun x_973->[])),fun x_972->(TBase(TUnit,fun x_974->[]))))));
  "k_198",(TFun((TBase(TInt,fun x_976->[])),fun x_975->(TBase(TUnit,fun x_977->[]))));
  "main_200",(TFun((TBase(TInt,fun x_979->[])),fun x_978->(TFun((TFun((TFun((TBase(TInt,fun x_983->[])),fun x_982->(TFun((TFun((TBase(TInt,fun x_986->[])),fun x_985->(TBase(TUnit,fun x_987->[])))),fun x_984->(TBase(TUnit,fun x_988->[])))))),fun x_981->(TFun((TBase(TInt,fun x_990->[])),fun x_989->(TBase(TUnit,fun x_991->[])))))),fun x_980->(TBase(TUnit,fun x_992->[]))))));
  "make_list_203",(TFun((TBase(TInt,fun x_994->[])),fun x_993->(TFun((TFun((TFun((TBase(TInt,fun x_998->[])),fun x_997->(TFun((TFun((TBase(TInt,fun x_1001->[])),fun x_1000->(TBase(TUnit,fun x_1002->[])))),fun x_999->(TBase(TUnit,fun x_1003->[])))))),fun x_996->(TFun((TBase(TInt,fun x_1005->[(App((App((Const Geq),(x_1005))),(Const (Int 2))));(App((App((Const Geq),(x_1005))),(Const (Int 1))))])),fun x_1004->(TBase(TUnit,fun x_1006->[])))))),fun x_995->(TBase(TUnit,fun x_1007->[]))))));
  "make_list_list_209",(TFun((TBase(TInt,fun x_1009->[])),fun x_1008->(TFun((TFun((TFun((TBase(TInt,fun x_1013->[(App((App((Const Geq),(x_1013))),(Const (Int 1))))])),fun x_1012->(TFun((TFun((TFun((TBase(TInt,fun x_1017->[])),fun x_1016->(TFun((TFun((TBase(TInt,fun x_1020->[])),fun x_1019->(TBase(TUnit,fun x_1021->[])))),fun x_1018->(TBase(TUnit,fun x_1022->[])))))),fun x_1015->(TFun((TBase(TInt,fun x_1024->[(App((App((Const Geq),(x_1024))),(Const (Int 2))));(App((App((Const Geq),(x_1024))),(Const (Int 1))))])),fun x_1023->(TBase(TUnit,fun x_1025->[])))))),fun x_1014->(TBase(TUnit,fun x_1026->[])))))),fun x_1011->(TFun((TBase(TInt,fun x_1028->[(App((App((Const EqInt),(x_1028))),(Const (Int 0))));(App((App((Const EqInt),(x_1028))),(Const (Int 1))))])),fun x_1027->(TBase(TUnit,fun x_1029->[])))))),fun x_1010->(TBase(TUnit,fun x_1030->[]))))));
  "map_215",(TFun((TFun((TFun((TBase(TInt,fun x_1034->[])),fun x_1033->(TFun((TFun((TBase(TInt,fun x_1037->[])),fun x_1036->(TBase(TUnit,fun x_1038->[])))),fun x_1035->(TBase(TUnit,fun x_1039->[])))))),fun x_1032->(TFun((TBase(TInt,fun x_1041->[(App((App((Const Geq),(x_1041))),(Const (Int 2))));(App((App((Const Geq),(x_1041))),(Const (Int 1))))])),fun x_1040->(TFun((TFun((TBase(TInt,fun x_1044->[])),fun x_1043->(TBase(TUnit,fun x_1045->[])))),fun x_1042->(TBase(TUnit,fun x_1046->[])))))))),fun x_1031->(TFun((TFun((TBase(TInt,fun x_1049->[(App((App((Const Geq),(x_1049))),(Const (Int 1))));(App((App((Const Geq),(x_1049))),(Const (Int 0))))])),fun x_1048->(TFun((TFun((TFun((TBase(TInt,fun x_1053->[])),fun x_1052->(TFun((TFun((TBase(TInt,fun x_1056->[])),fun x_1055->(TBase(TUnit,fun x_1057->[])))),fun x_1054->(TBase(TUnit,fun x_1058->[])))))),fun x_1051->(TFun((TBase(TInt,fun x_1060->[(App((App((Const Geq),(x_1060))),(Const (Int 2))));(App((App((Const Geq),(x_1060))),(Const (Int 1))))])),fun x_1059->(TBase(TUnit,fun x_1061->[])))))),fun x_1050->(TBase(TUnit,fun x_1062->[])))))),fun x_1047->(TFun((TBase(TInt,fun x_1064->[(App((App((Const EqInt),(x_1064))),(Const (Int 0))));(App((App((Const EqInt),(x_1064))),(Const (Int 1))))])),fun x_1063->(TFun((TFun((TFun((TBase(TInt,fun x_1068->[])),fun x_1067->(TFun((TFun((TBase(TInt,fun x_1071->[])),fun x_1070->(TBase(TUnit,fun x_1072->[])))),fun x_1069->(TBase(TUnit,fun x_1073->[])))))),fun x_1066->(TFun((TBase(TInt,fun x_1075->[])),fun x_1074->(TBase(TUnit,fun x_1076->[])))))),fun x_1065->(TBase(TUnit,fun x_1077->[]))))))))))],


["main_1",[],(Const True),[],(App((Const RandInt),(Var "k_198")));
 "cons_2",["r2_3";"x2_4";"x_5";"xs1_6";"xs2_7";"k_8"],(Const True),[],(App((App((Var "k_8"),(App((App((App((App((App((Var "f_94"),(Var "r2_3"))),(Var "x2_4"))),(Var "x_5"))),(Var "xs2_7"))),(Var "xs1_6"))))),(App((App((Const Add),(Var "xs2_7"))),(Const (Int 1))))));"cons_9",["m_10";"x_11";"xs1_12";"xs2_13";"k_14"],(Const True),[],(App((App((Var "k_14"),(App((App((App((App((Var "f_46"),(Var "m_10"))),(Var "x_11"))),(Var "xs2_13"))),(Var "xs1_12"))))),(App((App((Const Add),(Var "xs2_13"))),(Const (Int 1))))));"cons_15",["m_10";"x_17";"xs1_18";"xs2_19";"k_20"],(Const True),[],(App((App((Var "k_20"),(App((App((App((App((Var "f_28"),(Var "m_10"))),(Var "x_17"))),(Var "xs2_19"))),(Var "xs1_18"))))),(App((App((Const Add),(Var "xs2_19"))),(Const (Int 1))))));"cons_21",["m_22";"x1_23";"x2_24";"xs1_25";"xs2_26";"k_27"],(Const True),[],(App((App((Var "k_27"),(App((App((App((App((App((Var "f_64"),(Var "m_22"))),(Var "x2_24"))),(Var "xs2_26"))),(Var "x1_23"))),(Var "xs1_25"))))),(App((App((Const Add),(Var "xs2_26"))),(Const (Int 1))))));"f_28",["m_10";"x_17";"xs2_19";"xs1_18";"i_33";"k_34"],(App((App((Const EqInt),(Var "i_33"))),(Const (Int 0)))),[],(App((Var "k_34"),(Var "x_17")));"f_28",["m_10";"x_17";"xs2_19";"xs1_18";"i_33";"k_34"],(App((Const Not),(App((App((Const EqInt),(Var "i_33"))),(Const (Int 0)))))),[],(App((App((Var "xs1_18"),(App((App((Const Sub),(Var "i_33"))),(Const (Int 1)))))),(Var "k_34")));"f_42",["m_10";"x_44";"k_45"],(Const True),[],(Const Bottom);"f_46",["m_10";"x_11";"xs2_13";"xs1_12";"i_51";"k_52"],(App((App((Const EqInt),(Var "i_51"))),(Const (Int 0)))),[],(App((Var "k_52"),(Var "x_11")));"f_46",["m_10";"x_11";"xs2_13";"xs1_12";"i_51";"k_52"],(App((Const Not),(App((App((Const EqInt),(Var "i_51"))),(Const (Int 0)))))),[],(App((App((Var "xs1_12"),(App((App((Const Sub),(Var "i_51"))),(Const (Int 1)))))),(Var "k_52")));"f_60",["m_22";"x_62";"k_63"],(Const True),[],(Const Bottom);"f_64",["m_22";"x2_24";"xs2_26";"x1_23";"xs1_25";"i_70";"k_71"],(App((App((Const EqInt),(Var "i_70"))),(Const (Int 0)))),[],(App((App((Var "k_71"),(Var "x1_23"))),(Var "x2_24")));"f_64",["m_22";"x2_24";"xs2_26";"x1_23";"xs1_25";"i_70";"k_71"],(App((Const Not),(App((App((Const EqInt),(Var "i_70"))),(Const (Int 0)))))),[],(App((App((Var "xs1_25"),(App((App((Const Sub),(Var "i_70"))),(Const (Int 1)))))),(Var "k_71")));"f_80",["x2_81";"x1_82";"x_83";"k_84"],(Const True),[],(App((App((Var "x1_82"),(App((App((Const Add),(Var "x_83"))),(Const (Int 1)))))),(Var "k_84")));"f_85",["x2_4";"x_87";"k_88"],(Const True),[],(Const Bottom);"f_89",["x2_4";"x1_91";"x_92";"k_93"],(Const True),[],(App((App((Var "x1_91"),(App((App((Const Add),(Var "x_92"))),(Const (Int 1)))))),(Var "k_93")));"f_94",["r2_3";"x2_4";"x_5";"xs2_7";"xs1_6";"i_100";"k_101"],(App((App((Const EqInt),(Var "i_100"))),(Const (Int 0)))),[],(App((Var "k_101"),(Var "x_5")));"f_94",["r2_3";"x2_4";"x_5";"xs2_7";"xs1_6";"i_100";"k_101"],(App((Const Not),(App((App((Const EqInt),(Var "i_100"))),(Const (Int 0)))))),[],(App((App((Var "xs1_6"),(App((App((Const Sub),(Var "i_100"))),(Const (Int 1)))))),(Var "k_101")));"f_110",["b_111";"x1_82";"x2_81";"k_114"],(Var "b_111"),[],(App((App((Var "x1_82"),(Const (Int 0)))),(Var "k_114")));"f_110",["b_111";"x1_82";"x2_81";"k_114"],(App((Const Not),(Var "b_111"))),[],(Const Bottom);"f_120",["b_121";"f_122";"x1_91";"x2_4";"k_125"],(Var "b_121"),[],(App((App((Var "x1_91"),(Const (Int 0)))),(App((App((App((App((Var "k_169"),(Var "x2_4"))),(Var "f_122"))),(Var "k_125"))),(Var "x1_91")))));"f_120",["b_121";"f_122";"x1_91";"x2_4";"k_125"],(App((Const Not),(Var "b_121"))),[],(Const Bottom);"head_132",["x1_82";"x2_81";"k_114"],(App((App((Const EqInt),(Var "x2_81"))),(Const (Int 0)))),[(Event "fail")],(App((App((Var "k_166"),(Var "x2_81"))),(Const Unit)));"head_132",["x1_82";"x2_81";"k_114"],(App((Const Not),(App((App((Const EqInt),(Var "x2_81"))),(Const (Int 0)))))),[],(App((App((App((App((Var "f_110"),(App((App((Const Leq),(Const (Int 1)))),(Var "x2_81"))))),(Var "x1_82"))),(Var "x2_81"))),(Var "k_114")));"k_140",["m_10";"k_142";"r_143"],(Const True),[],(App((App((Var "make_list_203"),(App((App((Const Sub),(Var "m_10"))),(Const (Int 1)))))),(App((App((App((Var "k_144"),(Var "m_10"))),(Var "r_143"))),(Var "k_142")))));"k_144",["m_10";"r_143";"k_142";"r1_148";"r2_149"],(Const True),[],(App((App((App((App((App((Var "cons_9"),(Var "m_10"))),(Var "r_143"))),(Var "r1_148"))),(Var "r2_149"))),(Var "k_142")));"k_150",["m_22";"k_152";"r1_153";"r2_154"],(Const True),[],(App((App((Var "make_list_list_209"),(App((App((Const Sub),(Var "m_22"))),(Const (Int 1)))))),(App((App((App((App((Var "k_159"),(Var "m_22"))),(Var "r2_154"))),(Var "k_152"))),(Var "r1_153")))));"k_155",["m_22";"k_152";"r_158"],(Const True),[],(App((App((Var "make_list_203"),(Var "r_158"))),(App((App((Var "k_150"),(Var "m_22"))),(Var "k_152")))));"k_159",["m_22";"r2_154";"k_152";"r1_153";"r1_164";"r2_165"],(Const True),[],(App((App((App((App((App((App((Var "cons_21"),(Var "m_22"))),(Var "r1_153"))),(Var "r2_154"))),(Var "r1_164"))),(Var "r2_165"))),(Var "k_152")));"k_166",["x2_81";"r_168"],(Const True),[],(Const Bottom);"k_169",["x2_4";"f_122";"k_125";"x1_91";"r1_174";"r2_3"],(Const True),[],(App((App((App((Var "f_122"),(Var "r1_174"))),(Var "r2_3"))),(App((App((App((App((App((Var "k_176"),(Var "r2_3"))),(Var "x2_4"))),(Var "f_122"))),(Var "k_125"))),(Var "x1_91")))));"k_176",["r2_3";"x2_4";"f_122";"k_125";"x1_91";"r_182"],(Const True),[],(App((App((App((App((Var "map_215"),(Var "f_122"))),(App((App((Var "f_89"),(Var "x2_4"))),(Var "x1_91"))))),(App((App((Const Sub),(Var "x2_4"))),(Const (Int 1)))))),(App((App((App((App((Var "k_183"),(Var "r2_3"))),(Var "r_182"))),(Var "x2_4"))),(Var "k_125")))));"k_183",["r2_3";"r_182";"x2_4";"k_125";"r1_188";"r2_189"],(Const True),[],(App((App((App((App((App((App((Var "cons_2"),(Var "r2_3"))),(Var "x2_4"))),(Var "r_182"))),(Var "r1_188"))),(Var "r2_189"))),(Var "k_125")));"k_190",["m_191";"k_192";"r1_193";"r2_194"],(Const True),[],(App((App((App((App((Var "map_215"),(Var "head_132"))),(Var "r1_193"))),(Var "r2_194"))),(Var "k_192")));"k_195",["r1_196";"r2_197"],(Const True),[],(Const Unit);"k_198",["r_199"],(Const True),[],(App((App((Var "main_200"),(Var "r_199"))),(Var "k_195")));"main_200",["m_191";"k_192"],(Const True),[],(App((App((Var "make_list_list_209"),(Var "m_191"))),(App((App((Var "k_190"),(Var "m_191"))),(Var "k_192")))));"make_list_203",["m_10";"k_142"],(App((App((Const Leq),(Var "m_10"))),(Const (Int 0)))),[],(App((App((App((App((App((Var "cons_15"),(Var "m_10"))),(Const (Int 100)))),(App((Var "f_42"),(Var "m_10"))))),(Const (Int 0)))),(Var "k_142")));"make_list_203",["m_10";"k_142"],(App((Const Not),(App((App((Const Leq),(Var "m_10"))),(Const (Int 0)))))),[],(App((Const RandInt),(App((App((Var "k_140"),(Var "m_10"))),(Var "k_142")))));"make_list_list_209",["m_22";"k_152"],(App((App((Const Leq),(Var "m_22"))),(Const (Int 0)))),[],(App((App((Var "k_152"),(App((Var "f_60"),(Var "m_22"))))),(Const (Int 0))));"make_list_list_209",["m_22";"k_152"],(App((Const Not),(App((App((Const Leq),(Var "m_22"))),(Const (Int 0)))))),[],(App((Const RandInt),(App((App((Var "k_155"),(Var "m_22"))),(Var "k_152")))));"map_215",["f_122";"x1_91";"x2_4";"k_125"],(App((App((Const EqInt),(Var "x2_4"))),(Const (Int 0)))),[],(App((App((Var "k_125"),(App((Var "f_85"),(Var "x2_4"))))),(Const (Int 0))));"map_215",["f_122";"x1_91";"x2_4";"k_125"],(App((Const Not),(App((App((Const EqInt),(Var "x2_4"))),(Const (Int 0)))))),[],(App((App((App((App((App((Var "f_120"),(App((App((Const Leq),(Const (Int 1)))),(Var "x2_4"))))),(Var "f_122"))),(Var "x1_91"))),(Var "x2_4"))),(Var "k_125")))],"main_1")






let make_ce_printer ce prog sol () =
  Format.printf "Inputs:@.";
  List.iter (fun t -> Format.printf "  %s;@." t) sol;
  Feasibility.print_ce_reduction ce prog

let pre prog =
  Id.save_counter ();
  Format.printf "Program with abstraction types (CEGAR-cycle %d)::@.%a@." !Flag.cegar_loop CEGAR_print.print_prog_typ prog
(*;
  Format.printf "Program with abstraction types (CEGAR-cycle %d)::@.%a@." !Flag.cegar_loop CEGAR_print.print_prog_as_tree prog*
*)

let post () =
  incr Flag.cegar_loop;
  (**)
  Wrapper.reopen_cvc3 ();
  Wrapper2.reopen_cvc3 ();
  (**)
  Id.reset_counter ()

let rec cegar prog preds ces =
  let () = pre prog in
  let abst = CEGAR_abst.abstract prog in
  let result = ModelCheck.check abst prog in
    match result,ces with
        None,_ -> prog, None
      | Some ce, ce'::_ when ce = ce' -> raise NoProgress;
      | Some ce, _ ->
          if !Flag.print_eval_abst then CEGAR_abst.eval_abst_cbn prog abst ce;
          Feasibility.print_ce_reduction ce prog;
          match Feasibility.check ce prog with
              Feasibility.Feasible (env, sol) -> prog, Some (make_ce_printer ce prog sol)
            | Feasibility.Infeasible prefix ->
                let ces' = ce::ces in
                let prog' = Refine.refine preds prefix ces' prog in
                  post ();
                  cegar prog' preds ces'
