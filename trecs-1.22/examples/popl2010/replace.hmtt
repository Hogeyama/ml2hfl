Replace sa sb x = Conv sa (C1 sb x).
C1 sb x u = Conv sb (Repl x u).
Repl x u v = case x of
	| a y => u(Repl y u v)
	| b y => v(Repl y u v)
	| e => e
.
Conv x k = case x of
	| a y => Conv y (C2 k a)
	| b y => Conv y (C2 k b)
	| e => k I
.
C2 k y z = k(Concat y z).
Concat x y z = x(y z).
I x = x.